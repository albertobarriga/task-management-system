{% extends "base.html" %}

{% block content %}
<h2>{% if form.instance.id %}Edit{% else %}Create{% endif %} Task</h2>

<form method="post">
    {% csrf_token %}
    
    <div class="form-group">
        <label for="title">Title:</label>
        <input type="text" id="title" name="title" value="{{ form.title.value|default:'' }}" required>
    </div>
    
    <div class="form-group">
        <label for="description">Description:</label>
        <textarea id="description" name="description" rows="4">{{ form.description.value|default:'' }}</textarea>
    </div>
    
    <div class="grid-2">
        <div class="form-group">
            <label for="status">Status:</label>
            <select id="status" name="status">
                {% for value, label in form.fields.status.choices %}
                    <option value="{{ value }}" {% if form.status.value == value %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-group">
            <label for="priority">Priority:</label>
            <select id="priority" name="priority">
                {% for value, label in form.fields.priority.choices %}
                    <option value="{{ value }}" {% if form.priority.value == value %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
    
    <div class="form-group">
        <label for="due_date">Due Date:</label>
        <input type="datetime-local" id="due_date" name="due_date" 
               value="{{ form.due_date.value|date:'Y-m-d\TH:i'|default:'' }}" required>
    </div>
    
    <div class="grid-2">
        <div class="form-group">
            <label for="estimated_hours">Estimated Hours:</label>
            <input type="number" id="estimated_hours" name="estimated_hours" 
                   value="{{ form.estimated_hours.value|default:'0' }}" step="0.5" min="0" required>
        </div>
        
        <div class="form-group">
            <label for="actual_hours">Actual Hours:</label>
            <input type="number" id="actual_hours" name="actual_hours" 
                   value="{{ form.actual_hours.value|default:'' }}" step="0.5" min="0">
        </div>
    </div>

    <div class="form-group">
        <label for="assigned_users">Assign to Users:</label>
        <select id="assigned_users" name="assigned_users" multiple style="height: 120px;">
            {% for user in form.fields.assigned_users.queryset %}
                <option value="{{ user.id }}" 
                    {% if user in form.assigned_users.value %}selected{% endif %}>
                    {{ user.username }} - {{ user.get_full_name|default:user.email }}
                </option>
            {% endfor %}
        </select>
        <small class="form-text">Hold Ctrl/Cmd to select multiple users</small>
    </div>

    <div style="margin: 20px 0;">
        <button type="submit" class="btn">Save Task</button>
        <a href="{% url 'tasks:task_list' %}" class="btn btn-secondary">Cancel</a>
    </div>
</form>

<style>
    
select[multiple] {
    min-height: 120px;
    padding: 8px;
}
.form-text {
    color: #6c757d;
    font-size: 12px;
}
</style>
{% endblock %}